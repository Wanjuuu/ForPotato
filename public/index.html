<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>ì´ë ¥ë²ˆí˜¸ ì¡°íšŒ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>ğŸ® ë‹¤ì¤‘ ì´ë ¥ë²ˆí˜¸ ì¡°íšŒ</h2>

<form class="mainForm" action="/search" method="POST" enctype="multipart/form-data">
    <div>
    <div class="container">
        <div class="card">
            <h3>1) ì´ë ¥ë²ˆí˜¸ ì…ë ¥</h3>
            <p>í•œ ì¤„ì— í•˜ë‚˜ì”© ì…ë ¥í•˜ì„¸ìš”.</p>
<textarea class="textarea" name="traceNos" placeholder="ì˜ˆ: 222222222222&#10;333333333333" required></textarea>
        </div>

        <!-- <div class="card">
            <h3>2) ë°ì´í„° ì„ íƒ (.xlsx)</h3>
            <p>ì—‘ì…€ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.</p>
            <input type="file" name="excelFile"/>
        </div> -->
    </div>
         <button type="submit">ì¡°íšŒ</button>
    </div>
 </form>
<!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
<div id="loadingOverlay">
    <div class="loader"></div>
    <p>ì¡°íšŒ ì¤‘ì…ë‹ˆë‹¤â€¦</p>
</div>

</body>
</html>

<script>
    const form = document.querySelector("form");

    form.addEventListener("submit", (e) => {
        const textarea = form.traceNos.value.trim();
        const lines = textarea.split(/\r?\n/);

        for (const [i, line] of lines.entries()) {
            const cleaned = line.replace(/\s+/g, ""); // ê³µë°± ì œê±°

            if (!/^\d{12}$/.test(cleaned)) {
                e.preventDefault();
                alert(`ë¼ì¸ ${i + 1}ë²ˆ: ê³µë°± ì œì™¸ 12ìë¦¬ ìˆ«ìë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤!`);
                return;
            }
        }

        // âœ… ì—¬ê¸°ê¹Œì§€ ì™”ë‹¤ëŠ” ê±´: ìœ íš¨ì„± í†µê³¼
        // ğŸ‘‰ ë¡œë”© í‘œì‹œ
        const overlay = document.getElementById("loadingOverlay");
        if (overlay) {
            overlay.style.display = "flex";
        }

        // ë²„íŠ¼ ì¤‘ë³µ í´ë¦­ ë°©ì§€ (ì„ íƒ)
        const btn = form.querySelector("button");
        if (btn) {
            btn.disabled = true;
            btn.innerText = "ì¡°íšŒ ì¤‘...";
        }
    });
    
    window.addEventListener("pageshow", function () {
    const overlay = document.getElementById("loadingOverlay");
    if (overlay) {
        overlay.style.display = "none";
    }

    const btn = document.querySelector("form button");
    if (btn) {
        btn.disabled = false;
        btn.innerText = "ì¡°íšŒí•˜ê¸°";
    }
});
</script>